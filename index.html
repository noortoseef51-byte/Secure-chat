<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>BOSS CONTROL | HQ EXCLUSIVE</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #050507; --glow: #00f2ff; --danger: #ff2e63; --border: rgba(0, 242, 255, 0.2); --gold: #d4af37; --success: #25D366; }
    * { box-sizing: border-box; }
    body { background: var(--bg); color: #e0e0e0; font-family: 'Inter', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100dvh; overflow: hidden; }

    /* Layout - Desktop (Side by Side) */
    .main-container { flex: 1; display: flex; overflow: hidden; }
    .video-grid { flex: 1; padding: 10px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; background: rgba(0,0,0,0.5); overflow-y: auto; }
    .sidebar { width: 350px; border-left: 1px solid var(--border); display: flex; flex-direction: column; background: #08080a; transition: 0.3s; }

    /* Mobile Responsive (Stack Layout) */
    @media (max-width: 768px) {
      .main-container { flex-direction: column; }
      .sidebar { width: 100%; height: 50%; border-left: none; border-top: 1px solid var(--border); }
      .video-grid { height: 50%; }
    }

    /* Message & Reply Style */
    #chat-msgs { flex: 1; overflow-y: auto; padding: 10px; }
    .msg-bubble { margin-bottom: 8px; padding: 8px; background: rgba(255,255,255,0.03); border-left: 3px solid var(--glow); font-size: 13px; cursor: pointer; }
    .reply-badge { font-size: 10px; color: var(--glow); background: rgba(0, 242, 255, 0.1); padding: 4px; border-radius: 4px; margin-bottom: 5px; border-left: 2px solid var(--glow); }
    #reply-preview { display: none; padding: 8px; background: #111; border-top: 2px solid var(--glow); font-size: 11px; color: var(--glow); justify-content: space-between; align-items: center; }

    /* UI Components */
    .top-header { width: 100%; min-height: 60px; background: rgba(20,20,25,0.95); border-bottom: 2px solid var(--glow); display: flex; justify-content: space-between; align-items: center; padding: 5px 15px; z-index: 100; flex-wrap: wrap; gap: 5px; }
    .btn { padding: 6px 10px; background: transparent; color: var(--glow); border: 1px solid var(--glow); cursor: pointer; font-size: 9px; font-weight: bold; border-radius: 3px; text-transform: uppercase; }
    .video-card { border: 1px solid var(--border); background: #000; aspect-ratio: 16/9; border-radius: 8px; overflow: hidden; }
    video { width: 100%; height: 100%; object-fit: cover; }
    
    .admin-only { display: none; }
    .admin-mode .admin-only { display: inline-block; }
    .hidden { display: none !important; }

    #bossAlert, #flashBox { position: fixed; inset: 0; z-index: 99999; display: none; justify-content: center; align-items: center; flex-direction: column; background: rgba(0,0,0,0.95); border: 15px solid var(--glow); text-align: center; }
    .boss-text { font-family: 'Orbitron'; font-size: clamp(24px, 6vw, 50px); color: var(--glow); animation: pulse 0.3s infinite alternate; }
    @keyframes pulse { from { transform: scale(0.95); } to { transform: scale(1.05); } }
    
    #yt-area { width: 100%; aspect-ratio: 16/9; display: none; border-bottom: 2px solid var(--gold); }
    .share-div { padding: 5px 10px; border-top: 1px solid var(--border); }
  </style>
</head>
<body>

  <div id="bossAlert"><div class="boss-text">BOSS ENTERED</div></div>
  <div id="flashBox"><div class="boss-text" id="flashContent" style="color:var(--gold);"></div></div>
  <audio id="siren" src="https://www.soundjay.com/buttons/beep-01a.mp3"></audio>

  <div id="loginBox" style="position:fixed; inset:0; background:#000; z-index:10000; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:20px;">
    <h2 style="font-family:'Orbitron'; color:var(--glow);">SECURE ACCESS</h2>
    <input type="text" id="uName" placeholder="NAME" style="padding:12px; margin:5px; width:260px; border:none;">
    <input type="password" id="uCode" placeholder="PASSKEY" style="padding:12px; margin:5px; width:260px; border:none;">
    <button class="btn" onclick="enterSuite()" style="width:260px; padding:15px; margin-top:10px; background:var(--glow); color:#000; border:none;">LOGIN HQ</button>
  </div>

  <header class="top-header hidden" id="headerUI">
    <div style="display:flex; gap:5px; align-items:center;">
      <span id="onlineCount" style="color:var(--success); font-size:10px; border:1px solid var(--success); padding:2px 5px;">LIVE: 1</span>
      <button class="btn admin-only" onclick="sendFlash()" style="color:var(--gold); border-color:var(--gold);">‚ö° FLASH</button>
      <button class="btn admin-only" onclick="deleteAllMessages()" style="color:var(--danger); border-color:var(--danger);">üóëÔ∏è CLEAR</button>
      <button class="btn admin-only" onclick="inviteUser()">üì≤ INVITE</button>
    </div>
    <div style="display:flex; gap:5px;">
      <button class="btn admin-only" onclick="setYT()">üéµ YT</button>
      <button class="btn" onclick="toggleCam()">üìπ CAM</button>
      <button class="btn" onclick="location.reload()" style="color:var(--danger); border-color:var(--danger);">EXIT</button>
    </div>
  </header>

  <div class="main-container hidden" id="suiteUI">
    <div class="video-grid" id="videoArea">
      <div class="video-card"><video id="localVid" autoplay muted playsinline></video></div>
    </div>
    <div class="sidebar">
      <div id="yt-area"><iframe id="yt-player" width="100%" height="100%" src="" frameborder="0" allow="autoplay" allowfullscreen></iframe></div>
      <div id="chat-msgs"></div>
      
      <div id="reply-preview">
        <span id="reply-info"></span>
        <span onclick="cancelReply()" style="cursor:pointer">‚úñ</span>
      </div>

      <div class="share-div">
        <button class="btn" onclick="shareHQ()" style="width:100%; color:var(--success); border-color:var(--success);">üì≤ SHARE HQ ACCESS</button>
      </div>

      <div style="padding:10px; display:flex; gap:5px; border-top:1px solid var(--border);">
        <input type="text" id="mInp" placeholder="Type signal..." style="flex:1; background:transparent; border:none; color:white; outline:none; font-size:14px;">
        <button class="btn" onclick="sendChat()">SEND</button>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = { apiKey: "AIzaSyA806HxxZejS_l5_pWAb9cJ0pbbhNhgR8A", authDomain: "call-2b58d.firebaseapp.com", projectId: "call-2b58d", appId: "1:693359105489:web:6802540c272a565d27bcf0" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    let myName = "", rid = "supreme_base_pro", isAdmin = false, currentReply = null;

    async function enterSuite() {
      const n = document.getElementById("uName").value.trim();
      const c = document.getElementById("uCode").value.trim();
      if(!n) return;
      if(n.toLowerCase() === "admin" && c === "1661@786") {
        isAdmin = true;
        document.body.classList.add("admin-mode");
        db.collection('rooms').doc(rid).set({ bossSignal: Date.now() }, {merge:true});
      }
      myName = n;
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("headerUI").classList.remove("hidden");
      document.getElementById("suiteUI").classList.remove("hidden");
      initChat(); listenBoss(); listenYT(); listenFlash(); updateOnline();
    }

    // --- Core Options ---
    function sendFlash() {
      const m = prompt("Announcement:");
      if(m) db.collection('rooms').doc(rid).update({ flashMsg: m, flashTime: Date.now() });
    }

    function listenFlash() {
      db.collection('rooms').doc(rid).onSnapshot(doc => {
        if(doc.exists && doc.data().flashMsg) {
          document.getElementById("flashContent").innerText = doc.data().flashMsg;
          document.getElementById("flashBox").style.display = "flex";
          document.getElementById("siren").play().catch(e=>{});
          setTimeout(() => { document.getElementById("flashBox").style.display = "none"; }, 5000);
        }
      });
    }

    function setYT() {
      const url = prompt("YouTube URL:");
      if(url) {
        let id = url.includes("v=") ? url.split("v=")[1].split("&")[0] : url.split("be/")[1];
        db.collection('rooms').doc(rid).update({ ytId: id });
      }
    }

    function listenYT() {
      db.collection('rooms').doc(rid).onSnapshot(doc => {
        const area = document.getElementById("yt-area");
        if(doc.exists && doc.data().ytId) {
          area.style.display = "block";
          document.getElementById("yt-player").src = `https://www.youtube.com/embed/${doc.data().ytId}?autoplay=1`;
        } else { area.style.display = "none"; }
      });
    }

    function shareHQ() {
      const url = window.location.href;
      if (navigator.share) {
        navigator.share({ title: 'HQ', url: url });
      } else {
        navigator.clipboard.writeText(url);
        alert("Link Copied!");
      }
    }

    function inviteUser() {
      const t = prompt("Invite Name:");
      if(t) window.open(`https://wa.me/?text=JOIN HQ: ${window.location.href}`);
    }

    // --- Chat & Reply & Delete ---
    function setReply(sender, text) {
      currentReply = { sender, text };
      document.getElementById("reply-info").innerText = `Replying to: ${sender}`;
      document.getElementById("reply-preview").style.display = "flex";
      document.getElementById("mInp").focus();
    }

    function cancelReply() { currentReply = null; document.getElementById("reply-preview").style.display = "none"; }

    function sendChat() {
      const i = document.getElementById("mInp");
      if(!i.value) return;
      const msgData = { name: myName, text: i.value, time: Date.now() };
      if(currentReply) { msgData.replyTo = currentReply; cancelReply(); }
      db.collection('rooms').doc(rid).collection('messages').add(msgData);
      i.value = "";
    }

    function initChat() {
      db.collection('rooms').doc(rid).collection('messages').orderBy('time').onSnapshot(snap => {
        const box = document.getElementById("chat-msgs"); box.innerHTML = "";
        snap.forEach(doc => {
          const d = doc.data();
          let rep = d.replyTo ? `<div class="reply-badge">‚Æë ${d.replyTo.sender}: ${d.replyTo.text}</div>` : "";
          box.innerHTML += `<div class="msg-bubble" onclick="setReply('${d.name}', '${d.text}')">${rep}<b>${d.name}:</b> ${d.text}</div>`;
        });
        box.scrollTop = box.scrollHeight;
      });
    }

    async function deleteAllMessages() {
      if(!confirm("Delete all messages?")) return;
      const snap = await db.collection('rooms').doc(rid).collection('messages').get();
      const batch = db.batch();
      snap.docs.forEach(doc => batch.delete(doc.ref));
      await batch.commit();
    }

    function listenBoss() {
      db.collection('rooms').doc(rid).onSnapshot(doc => {
        if(doc.exists && doc.data().bossSignal) {
          document.getElementById("bossAlert").style.display = "flex";
          document.getElementById("siren").play().catch(e=>{});
          setTimeout(() => { document.getElementById("bossAlert").style.display = "none"; }, 4000);
        }
      });
    }

    function updateOnline() {
      setInterval(() => { db.collection('rooms').doc(rid).collection('online').doc(myName).set({ t: Date.now() }); }, 10000);
      db.collection('rooms').doc(rid).collection('online').onSnapshot(snap => {
        let count = 0; snap.forEach(d => { if(Date.now() - d.data().t < 30000) count++; });
        document.getElementById("onlineCount").innerText = "LIVE: " + count;
      });
    }

    async function toggleCam() {
      const s = await navigator.mediaDevices.getUserMedia({video:true, audio:true});
      document.getElementById("localVid").srcObject = s;
    }
  </script>
</body>
</html>
