<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BOSS CONTROL | HQ</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #050507; --glow: #00f2ff; --danger: #ff2e63; --border: rgba(0, 242, 255, 0.2); }
    body { background: var(--bg); color: #e0e0e0; font-family: 'Inter', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
    
    /* Login Screen - Professional Style */
    .overlay { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    .login-header { font-family: 'Orbitron'; font-size: 42px; color: var(--glow); letter-spacing: 2px; margin-bottom: 30px; text-transform: uppercase; text-shadow: 0 0 15px var(--glow); }
    .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
    .login-card input { width: 180px; padding: 12px; background: rgba(255,255,255,0.05); border: 1px solid #fff; color: white; outline: none; font-size: 14px; }
    .login-btn { width: 380px; padding: 15px; background: transparent; border: 1px solid var(--glow); color: var(--glow); font-family: 'Orbitron'; cursor: pointer; transition: 0.3s; font-size: 16px; letter-spacing: 2px; }
    .login-btn:hover { background: var(--glow); color: #000; box-shadow: 0 0 20px var(--glow); }

    /* Header & UI */
    .top-header { width: 100%; height: 60px; background: rgba(20, 20, 25, 0.9); border-bottom: 2px solid var(--glow); display: flex; justify-content: space-between; align-items: center; padding: 0 20px; box-sizing: border-box; }
    .btn { padding: 6px 12px; background: transparent; color: var(--glow); border: 1px solid var(--glow); cursor: pointer; font-size: 10px; border-radius: 3px; font-weight: bold; }
    .btn-danger { color: var(--danger); border-color: var(--danger); }

    .main-container { flex: 1; display: flex; }
    .video-grid { flex: 1; padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; background: rgba(0,0,0,0.5); }
    .video-container { border: 1px solid var(--border); background: #000; aspect-ratio: 16/9; border-radius: 8px; overflow: hidden; }
    video { width: 100%; height: 100%; object-fit: cover; }

    .sidebar { width: 380px; border-left: 1px solid var(--border); display: flex; flex-direction: column; background: #08080a; }
    #yt-area { width: 100%; aspect-ratio: 16/9; background: #000; display: none; border-bottom: 1px solid var(--glow); }
    #chat-msgs { flex: 1; overflow-y: auto; padding: 15px; }
    .msg-bubble { margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.03); border-left: 3px solid var(--glow); cursor: pointer; font-size: 13px; }
    .reply-tag { font-size: 10px; color: #777; margin-bottom: 4px; display: block; }

    #reply-box { display: none; padding: 8px; background: rgba(0, 242, 255, 0.1); font-size: 11px; border-top: 1px solid var(--glow); }
    .admin-only { display: none; }
    .admin-mode .admin-only { display: inline-block; }
    .hidden { display: none !important; }
  </style>
</head>
<body>

  <audio id="siren" src="https://www.soundjay.com/buttons/beep-01a.mp3"></audio>

  <div id="loginBox" class="overlay">
    <div class="login-card">
      <div class="login-header">SECURE ACCESS</div>
      <div class="input-group">
        <input type="text" id="uName" placeholder="Admin">
        <input type="password" id="uCode" placeholder="PASSKEY">
      </div>
      <button class="login-btn" onclick="enterSuite()">LOGIN</button>
      <p id="err" style="color:var(--danger); text-align:center; font-size:12px; margin-top:10px;"></p>
    </div>
  </div>

  <header class="top-header hidden" id="headerUI">
    <div style="display:flex; gap:10px; align-items:center;">
      <span style="font-family:'Orbitron'; color:var(--glow); letter-spacing:2px;">HQ-SYSTEM</span>
      <button class="btn admin-only" onclick="setYT()">üéµ YT VIDEO</button>
      <button class="btn admin-only btn-danger" onclick="purgeChat()">üóëÔ∏è DELETE ALL</button>
    </div>
    <div style="display:flex; gap:10px;">
      <button class="btn admin-only" onclick="inviteUser()" style="border-color:#25D366; color:#25D366;">INVITE</button>
      <button class="btn" onclick="toggleCam()">üìπ CAM</button>
      <button class="btn btn-danger" onclick="location.reload()">EXIT</button>
    </div>
  </header>

  <div class="main-container hidden" id="suiteUI">
    <div class="video-grid">
      <div class="video-container"><video id="localVid" autoplay muted playsinline></video></div>
    </div>
    
    <div class="sidebar">
      <div id="yt-area">
        <iframe id="yt-player" width="100%" height="100%" src="" frameborder="0" allow="autoplay" allowfullscreen></iframe>
      </div>
      <div id="chat-msgs"></div>
      <div id="reply-box">Replying to: <span id="rep-name" style="color:var(--glow);"></span> <span onclick="cancelReply()" style="float:right; cursor:pointer; color:red;">X</span></div>
      <div style="padding:15px; display:flex; gap:8px; border-top:1px solid var(--border);">
        <input type="text" id="mInp" placeholder="Secure signal..." style="flex:1; background:transparent; border:none; color:white; outline:none;">
        <button class="btn" onclick="sendChat()">SEND</button>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA806HxxZejS_l5_pWAb9cJ0pbbhNhgR8A",
      authDomain: "call-2b58d.firebaseapp.com",
      projectId: "call-2b58d",
      appId: "1:693359105489:web:6802540c272a565d27bcf0"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    let myName = "", rid = "supreme_base_pro", isAdmin = false, replyData = null;

    const lockedName = new URLSearchParams(window.location.search).get('join');

    async function enterSuite() {
      const n = document.getElementById("uName").value.trim();
      const c = document.getElementById("uCode").value.trim();
      if(!n) return;

      if(c === "1661@786") {
        isAdmin = true;
        document.body.classList.add("admin-mode");
        db.collection('rooms').doc(rid).set({ bossSignal: Date.now() }, {merge:true});
      } else if(lockedName && n.toLowerCase() !== lockedName.toLowerCase()) {
        document.getElementById("err").innerText = "Unauthorized Access"; return;
      }

      myName = n;
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("headerUI").classList.remove("hidden");
      document.getElementById("suiteUI").classList.remove("hidden");
      initChat(); listenBoss(); listenYT();
    }

    // Admin Functions
    async function purgeChat() {
      if(!confirm("Clear all logs?")) return;
      const snap = await db.collection('rooms').doc(rid).collection('messages').get();
      snap.forEach(doc => doc.ref.delete());
    }

    function setYT() {
      const url = prompt("YouTube Link:");
      if(url) {
        let id = url.includes("v=") ? url.split("v=")[1].split("&")[0] : url.split("be/")[1];
        db.collection('rooms').doc(rid).update({ ytId: id });
      }
    }

    // Chat & Reply
    function setReply(u, t) {
      replyData = { u, t };
      document.getElementById("reply-box").style.display = "block";
      document.getElementById("rep-name").innerText = u;
    }
    function cancelReply() { replyData = null; document.getElementById("reply-box").style.display = "none"; }

    function sendChat() {
      const i = document.getElementById("mInp");
      if(!i.value) return;
      db.collection('rooms').doc(rid).collection('messages').add({
        name: myName, text: i.value, time: Date.now(), reply: replyData
      });
      i.value = ""; cancelReply();
    }

    function initChat() {
      db.collection('rooms').doc(rid).collection('messages').orderBy('time').onSnapshot(snap => {
        const box = document.getElementById("chat-msgs"); box.innerHTML = "";
        snap.forEach(doc => {
          const d = doc.data();
          let r = d.reply ? `<span class="reply-tag">‚¨ë ${d.reply.u}: ${d.reply.t}</span>` : "";
          box.innerHTML += `<div class="msg-bubble" onclick="setReply('${d.name}', '${d.text}')">${r}<b>${d.name}:</b> ${d.text}</div>`;
        });
        box.scrollTop = box.scrollHeight;
      });
    }

    // Listeners
    function listenYT() {
      db.collection('rooms').doc(rid).onSnapshot(doc => {
        if(doc.exists && doc.data().ytId) {
          document.getElementById("yt-area").style.display = "block";
          document.getElementById("yt-player").src = `https://www.youtube.com/embed/${doc.data().ytId}?autoplay=1`;
        }
      });
    }
    function listenBoss() {
      db.collection('rooms').doc(rid).onSnapshot(doc => {
        if(doc.exists && doc.data().bossSignal) document.getElementById("siren").play();
      });
    }
    function inviteUser() {
      const t = prompt("Invite Name:");
      if(t) window.open(`https://wa.me/?text=${window.location.origin}${window.location.pathname}?join=${encodeURIComponent(t)}`);
    }
    async function toggleCam() {
      const s = await navigator.mediaDevices.getUserMedia({video:true, audio:true});
      document.getElementById("localVid").srcObject = s;
    }
  </script>
</body>
</html>
