<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BOSS HQ | ENCRYPTED NODE</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #050507; --glow: #00f2ff; --gold: #d4af37; --danger: #ff2e63; --border: rgba(0, 242, 255, 0.2); }
    body { background: var(--bg); color: #e0e0e0; font-family: 'Inter', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
    
    .scanline { position: fixed; inset: 0; background: linear-gradient(to bottom, transparent 50%, rgba(0, 242, 255, 0.05) 50%); background-size: 100% 4px; pointer-events: none; z-index: 9999; animation: scan 10s linear infinite; }
    @keyframes scan { 0% { background-position: 0% 0%; } 100% { background-position: 0% 100%; } }

    .overlay { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; justify-content: center; align-items: center; }
    .login-card { background: rgba(10, 10, 15, 0.95); padding: 50px; border: 1px solid var(--glow); border-radius: 20px; text-align: center; }
    input { display: block; width: 300px; padding: 12px; margin-bottom: 15px; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: white; border-radius: 8px; outline: none; }

    .top-header { width: 100%; height: 65px; background: rgba(20, 20, 25, 0.95); border-bottom: 2px solid var(--glow); display: flex; justify-content: space-between; align-items: center; padding: 0 20px; box-sizing: border-box; z-index: 100; }
    .btn { padding: 8px 15px; background: transparent; color: var(--glow); border: 1px solid var(--glow); cursor: pointer; font-weight: 600; text-transform: uppercase; font-size: 10px; border-radius: 5px; transition: 0.3s; }
    .btn:hover { background: var(--glow); color: black; box-shadow: 0 0 15px var(--glow); }

    .main-container { flex: 1; display: flex; }
    .video-grid { flex: 1; padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; background: rgba(0,0,0,0.4); overflow-y: auto; }
    .video-wrap { position: relative; border: 2px solid var(--border); border-radius: 15px; overflow: hidden; background: #000; aspect-ratio: 16/9; }
    video { width: 100%; height: 100%; object-fit: cover; }
    .video-label { position: absolute; bottom: 10px; left: 10px; font-size: 10px; background: rgba(0,0,0,0.7); padding: 4px 8px; border-radius: 4px; color: var(--glow); }

    /* YT Player Section */
    #yt-container { width: 100%; aspect-ratio: 16/9; background: #000; border-bottom: 1px solid var(--border); display: none; }

    .sidebar { width: 380px; background: #08080a; border-left: 1px solid var(--border); display: flex; flex-direction: column; }
    #chat-msgs { flex: 1; overflow-y: auto; padding: 20px; }
    .msg-bubble { margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 10px; border-left: 3px solid var(--glow); cursor: pointer; }
    .reply-preview { font-size: 9px; color: #888; border-left: 2px solid #555; padding-left: 5px; margin-bottom: 5px; }

    .admin-only { display: none; }
    .admin-mode .admin-only { display: inline-block; }
    .hidden { display: none !important; }

    #reply-bar { display: none; padding: 8px; background: rgba(0, 242, 255, 0.1); font-size: 11px; border-top: 1px solid var(--glow); }
  </style>
</head>
<body>

  <div class="scanline"></div>
  <div id="bossAlert" style="position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:9000; display:none; justify-content:center; align-items:center; border:20px solid var(--glow);"><h1 style="font-family:'Orbitron'; color:var(--glow);">BOSS ENTERED</h1></div>

  <div id="loginBox" class="overlay">
    <div class="login-card">
      <h2 style="font-family:'Orbitron'; color:var(--glow);">NODE ACCESS</h2>
      <input type="text" id="uName" placeholder="IDENTITY NAME">
      <input type="password" id="uCode" placeholder="PASSKEY (FOR ADMIN)">
      <button class="btn" onclick="enterSuite()" style="width:100%; padding:15px;">AUTHORIZE ACCESS</button>
      <p id="errLog" style="color:var(--danger); font-size:10px; margin-top:10px;"></p>
    </div>
  </div>

  <header class="top-header hidden" id="headerUI">
    <div style="display:flex; gap:10px;">
      <span style="color:var(--glow); font-family:'Orbitron';">HQ-NODE</span>
      <button class="btn admin-only" onclick="setYTLink()" style="border-color:var(--gold); color:var(--gold);">ðŸŽµ GLOBAL YOUTUBE</button>
    </div>
    <div style="display:flex; gap:8px;">
      <button class="btn admin-only" id="lockBtn" onclick="toggleLock()">ðŸ”“ UNLOCKED</button>
      <button class="btn" onclick="toggleMedia()">ðŸ“¹ CAM</button>
      <button class="btn" style="border-color:var(--danger);" onclick="location.reload()">ðŸšª EXIT</button>
    </div>
  </header>

  <div class="main-container hidden" id="suiteUI">
    <div class="video-grid">
      <div class="video-wrap">
        <video id="localVid" autoplay muted playsinline></video>
        <div class="video-label" id="myLabel">CONNECTING...</div>
      </div>
    </div>

    <div class="sidebar">
      <div id="yt-container">
        <iframe id="yt-player" width="100%" height="100%" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      </div>

      <div id="chat-msgs"></div>

      <div id="reply-bar">
        Replying to: <span id="reply-to-user" style="color:var(--glow);"></span> 
        <button onclick="cancelReply()" style="float:right; background:none; border:none; color:var(--danger); cursor:pointer;">X</button>
      </div>

      <div style="padding:15px; border-top:1px solid var(--border); display:flex; gap:8px;">
        <input type="text" id="mInp" placeholder="Secure signal..." style="flex:1; margin:0; background:transparent; border:none; color:white;">
        <button class="btn" onclick="sendChat()">></button>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA806HxxZejS_l5_pWAb9cJ0pbbhNhgR8A",
      authDomain: "call-2b58d.firebaseapp.com",
      projectId: "call-2b58d",
      appId: "1:693359105489:web:6802540c272a565d27bcf0"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    let myName = "", rid = "supreme_base_pro", isAdmin = false, replyData = null;

    async function enterSuite() {
      const name = document.getElementById("uName").value.trim();
      const code = document.getElementById("uCode").value.trim();
      if(!name) return;

      if (code === "1661@786") {
        isAdmin = true;
        document.body.classList.add("admin-mode");
        db.collection('rooms').doc(rid).set({ bossT: Date.now() }, {merge:true});
      }

      myName = name;
      document.getElementById("loginBox").classList.add("hidden");
      document.getElementById("headerUI").classList.remove("hidden");
      document.getElementById("suiteUI").classList.remove("hidden");
      document.getElementById("myLabel").innerText = "USER: " + myName.toUpperCase();
      
      initChat(); listenLock(); listenYT();
    }

    // --- YOUTUBE SYSTEM ---
    function setYTLink() {
        const url = prompt("Paste YouTube Link (e.g., https://www.youtube.com/watch?v=XXXX):");
        if(url) {
            let videoId = "";
            if(url.includes("v=")) videoId = url.split("v=")[1].split("&")[0];
            else if(url.includes("be/")) videoId = url.split("be/")[1];

            if(videoId) {
                db.collection('rooms').doc(rid).update({ ytId: videoId, ytTime: Date.now() });
            }
        }
    }

    function listenYT() {
        db.collection('rooms').doc(rid).onSnapshot(doc => {
            if(doc.exists && doc.data().ytId) {
                const container = document.getElementById("yt-container");
                const player = document.getElementById("yt-player");
                container.style.display = "block";
                player.src = `https://www.youtube.com/embed/${doc.data().ytId}?autoplay=1`;
            }
        });
    }

    // --- CHAT & REPLY SYSTEM ---
    function setReply(u, t) {
        replyData = { user: u, text: t };
        document.getElementById("reply-bar").style.display = "block";
        document.getElementById("reply-to-user").innerText = u;
    }

    function cancelReply() {
        replyData = null;
        document.getElementById("reply-bar").style.display = "none";
    }

    function sendChat() {
      const i = document.getElementById("mInp");
      if(!i.value) return;
      const payload = { name: myName, text: i.value, time: Date.now() };
      if(replyData) { payload.replyTo = replyData.user; payload.replyMsg = replyData.text; }
      db.collection('rooms').doc(rid).collection('messages').add(payload);
      i.value = ""; cancelReply();
    }

    function initChat() {
      db.collection('rooms').doc(rid).collection('messages').orderBy('time').onSnapshot(snap => {
        const box = document.getElementById("chat-msgs"); box.innerHTML = "";
        snap.forEach(doc => {
          const d = doc.data();
          const replyHtml = d.replyTo ? `<div class="reply-preview">â¬‘ ${d.replyTo}: ${d.replyMsg}</div>` : "";
          box.innerHTML += `<div class="msg-bubble" onclick="setReply('${d.name}', '${d.text}')">${replyHtml}<b style="color:var(--glow); font-size:10px;">${d.name}</b><br>${d.text}</div>`;
        });
        box.scrollTop = box.scrollHeight;
      });
    }

    function listenLock() {
      db.collection('rooms').doc(rid).onSnapshot(doc => {
        if(doc.exists) {
          const l = doc.data().isLocked;
          const b = document.getElementById("lockBtn");
          if(b) b.innerText = l ? "ðŸ”’ LOCKED" : "ðŸ”“ UNLOCKED";
        }
      });
    }

    async function toggleMedia() {
        const stream = await navigator.mediaDevices.getUserMedia({video:true, audio:true});
        document.getElementById("localVid").srcObject = stream;
    }
  </script>
</body>
</html>
